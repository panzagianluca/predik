# CORS Fix: Myriad API Proxy

## Problem
The Myriad API doesn't set CORS headers, so direct browser requests from `localhost:3000` are blocked:
```
Access-Control-Allow-Origin header is present on the requested resource
```

## Solution
We've created Next.js API routes that act as a **server-side proxy**:

### API Routes Created:

1. **`/api/markets`** - Fetch all markets
   - Proxies to: `https://api-v1.staging.myriadprotocol.com/markets`
   - Supports query params: `state`, `token`, `network_id`
   - Includes caching (60s)

2. **`/api/markets/[slug]`** - Fetch single market
   - Proxies to: `https://api-v1.staging.myriadprotocol.com/markets/:slug`
   - Includes caching (30s)

### How It Works:

```
Browser (Client)  â†’  Next.js API Route (Server)  â†’  Myriad API
    â†“                         â†“                          â†“
 No CORS issue!      Fetches from server         Returns data
```

**Server-to-server** requests don't have CORS restrictions! âœ…

### Updated Files:

- `app/api/markets/route.ts` - Market list endpoint
- `app/api/markets/[slug]/route.ts` - Single market endpoint  
- `lib/myriad/api.ts` - Now calls `/api/markets` instead of direct API

### Benefits:

1. âœ… **No CORS errors** - Server-side requests bypass CORS
2. âœ… **Caching** - Reduces API calls with Next.js cache
3. âœ… **Error handling** - Better error messages
4. âœ… **Security** - Can add auth/rate limiting if needed

### Testing:

Visit http://localhost:3000/uitest and you should now see markets loading! ðŸŽ‰

If you want to test the API directly:
- http://localhost:3000/api/markets?network_id=11142220&state=open
- http://localhost:3000/api/markets/[any-market-slug]
